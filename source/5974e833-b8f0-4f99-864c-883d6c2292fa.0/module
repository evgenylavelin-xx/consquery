&НаКлиенте
Функция СобратьСтрокуПодключения()
	ИтоговаяСтрока = "ftp://" + 
		?(ЗначениеЗаполнено(Пользователь), Пользователь, "???") + ":" + ?(ЗначениеЗаполнено(Пароль), "***", "???") + "@" 
		+ ?(ЗначениеЗаполнено(Адрес), Адрес, "???") + ":" + ?(ЗначениеЗаполнено(Порт), Порт, "21");
КонецФункции // СобратьСтрокуПодключения()

Процедура ДействияФормыСохранить(Кнопка)
	Закрыть(Новый Структура("Адрес, Пользователь, Пароль, Порт", Адрес, Пользователь, Пароль, Порт));
КонецПроцедуры

Процедура ИтоговаяСтрокаОткрытие(Элемент, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	Попытка
		Состояние("Попытка подключения к FTP. Подождите...");
		FTPСоединение = Новый FTPСоединение(Адрес, ?(ЗначениеЗаполнено(Порт), Порт, "21"), Пользователь, Пароль);
		FTPСоединение = Неопределено;
		ПоказатьПредупреждение(, "Подключение выполнено.", 10, "Проверка подключения.");
	Исключение
		ПоказатьПредупреждение(, "Ошибка. Подключение не выполнено.", 10, "Проверка подключения.");
		Сообщить(ОписаниеОшибки());
	КонецПопытки; 
КонецПроцедуры

Процедура АдресПриИзменении(Элемент)
	СобратьСтрокуПодключения();
КонецПроцедуры

Процедура ПортПриИзменении(Элемент)
	СобратьСтрокуПодключения();
КонецПроцедуры

Процедура ПользовательПриИзменении(Элемент)
	СобратьСтрокуПодключения();
КонецПроцедуры

Процедура ПарольПриИзменении(Элемент)
	СобратьСтрокуПодключения();
КонецПроцедуры

Процедура ПриОткрытии()
	СобратьСтрокуПодключения();
КонецПроцедуры
